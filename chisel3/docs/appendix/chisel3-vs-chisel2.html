<!DOCTYPE html><html><head><title>Chisel/FIRRTL: Chisel3 vs. Chisel2</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="the Chisel/FIRRTL Developers" /><meta name="description" content="Chisel/FIRRTL
Hardware Compiler Framework" /><meta name="og:image" content="/img/poster.png" /><meta name="image" property="og:image" content="/img/poster.png" /><meta name="og:title" content="Chisel/FIRRTL: Chisel3 vs. Chisel2" /><meta name="title" property="og:title" content="Chisel/FIRRTL: Chisel3 vs. Chisel2" /><meta name="og:site_name" content="Chisel/FIRRTL" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="Chisel/FIRRTL
Hardware Compiler Framework" /><link rel="icon" type="image/png" href="/img/favicon.png" /><meta name="twitter:title" content="Chisel/FIRRTL: Chisel3 vs. Chisel2" /><meta name="twitter:image" content="https://www.chisel-lang.org/img/poster.png" /><meta name="twitter:description" content="Chisel/FIRRTL
Hardware Compiler Framework" /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:site" content="@chisel_lang" /><link rel="icon" type="image/png" sizes="16x16" href="/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/highlight/styles/vs.css" /><link rel="stylesheet" href="/css/pattern-style.css" /><script async="async">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-145179088-1' , 'auto');
ga('send', 'pageview');
      </script></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/" class="brand"><div class="brand-wrapper"><span>Chisel/FIRRTL</span></div></a></li> <li><a href="/chisel3/docs/introduction.html" class="">Chisel3</a></li> <li><a href="/chisel3/docs/resources/resources.html" class="">Resources</a> <ul class="sub-section"> <li><a href="/chisel3/docs/resources/faqs.html" class="">FAQ</a></li></ul></li> <li><a href="/chisel3/docs/cookbooks/cookbooks.html" class="">Cookbooks</a> <ul class="sub-section"> <li><a href="/chisel3/docs/cookbooks/cookbook.html" class="">General Cookbook</a></li> <li><a href="/chisel3/docs/cookbooks/naming.html" class="">Naming Cookbook</a></li> <li><a href="/chisel3/docs/cookbooks/troubleshooting.html" class="">Troubleshooting</a></li> <li><a href="/chisel3/docs/cookbooks/dataview.html" class="">DataView Cookbook</a></li> <li><a href="/chisel3/docs/cookbooks/hierarchy.html" class="">Hierarchy Cookbook</a></li></ul></li> <li><a href="/chisel3/docs/explanations/explanations.html" class="">Explanations</a> <ul class="sub-section"> <li><a href="/chisel3/docs/explanations/motivation.html" class="">Motivation</a></li> <li><a href="/chisel3/docs/explanations/supported-hardware.html" class="">Supported Hardware</a></li> <li><a href="/chisel3/docs/explanations/data-types.html" class="">Data Types</a></li> <li><a href="/chisel3/docs/explanations/dataview.html" class="">Dataview</a></li> <li><a href="/chisel3/docs/explanations/bundles-and-vecs.html" class="">Bundles and Vecs</a></li> <li><a href="/chisel3/docs/explanations/combinational-circuits.html" class="">Combinational Circuits</a></li> <li><a href="/chisel3/docs/explanations/operators.html" class="">Operators</a></li> <li><a href="/chisel3/docs/explanations/width-inference.html" class="">Width Inference</a></li> <li><a href="/chisel3/docs/explanations/functional-abstraction.html" class="">Functional Abstraction</a></li> <li><a href="/chisel3/docs/explanations/ports.html" class="">Ports</a></li> <li><a href="/chisel3/docs/explanations/modules.html" class="">Modules</a></li> <li><a href="/chisel3/docs/explanations/sequential-circuits.html" class="">Sequential Circuits</a></li> <li><a href="/chisel3/docs/explanations/memories.html" class="">Memories</a></li> <li><a href="/chisel3/docs/explanations/interfaces-and-connections.html" class="">Interfaces and Connections</a></li> <li><a href="/chisel3/docs/explanations/blackboxes.html" class="">Blackboxes</a></li> <li><a href="/chisel3/docs/explanations/chisel-enum.html" class="">Enumerations</a></li> <li><a href="/chisel3/docs/explanations/functional-module-creation.html" class="">Functional Module Creation</a></li> <li><a href="/chisel3/docs/explanations/muxes-and-input-selection.html" class="">Muxes and Input Selection</a></li> <li><a href="/chisel3/docs/explanations/multi-clock.html" class="">Multiple Clock Domains</a></li> <li><a href="/chisel3/docs/explanations/reset.html" class="">Reset</a></li> <li><a href="/chisel3/docs/explanations/polymorphism-and-parameterization.html" class="">Polymorphism and Parameterization</a></li> <li><a href="/chisel3/docs/explanations/printing.html" class="">Printing in Chisel</a></li> <li><a href="/chisel3/docs/explanations/naming.html" class="">Naming</a></li> <li><a href="/chisel3/docs/explanations/unconnected-wires.html" class="">Unconnected Wires</a></li> <li><a href="/chisel3/docs/explanations/annotations.html" class="">Annotations</a></li> <li><a href="/chisel3/docs/explanations/connection-operators.html" class="">Deep Dive into Connection Operators</a></li></ul></li> <li><a href="/chisel3/docs/appendix/appendix.html" class="">Appendix</a> <ul class="sub-section"> <li><a href="/chisel3/docs/appendix/chisel3-vs-chisel2.html" class=" active ">Chisel3 vs. Chisel2</a></li> <li><a href="/chisel3/docs/appendix/experimental-features.html" class="">Experimental Features</a></li> <li><a href="/chisel3/docs/appendix/versioning.html" class="">Versioning</a></li> <li><a href="/chisel3/docs/appendix/upgrading-from-chisel-3-4.html" class="">Upgrading From Chisel 3.4 to 3.5</a></li> <li><a href="/chisel3/docs/appendix/upgrading-from-scala-2-11.html" class="">Upgrading From Scala 2.11</a></li></ul></li> <li><a href="/chisel3/docs/developers/developers.html" class="">Developers</a> <ul class="sub-section"> <li><a href="/chisel3/docs/developers/style.html" class="">Style Guide</a></li> <li><a href="/chisel3/docs/developers/sbt-subproject.html" class="">sbt Subproject</a></li> <li><a href="/chisel3/docs/developers/test-coverage.html" class="">Test Coverage</a></li></ul></li> <li><a href="/api/" class="">API Documentation</a> <ul class="sub-section"> <li><a href="/api/latest/" class="">Latest</a></li> <li><a href="/api/3.5.2/" class="">3.5</a></li> <li><a href="/api/3.4.4/" class="">3.4</a></li> <li><a href="/api/3.3.3/" class="">3.3</a></li> <li><a href="/api/3.2.8/" class="">3.2</a></li></ul></li>            </ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li class="search-nav hidden-xs hidden-sm"><div id="search-dropdown"><label><i class="fa fa-search"></i>Search</label><input id="search-bar" type="text" placeholder="Enter keywords here..." onclick="displayToggleSearch(event)" /><ul id="search-dropdown-content" class="dropdown dropdown-content"></ul></div></li></ul></div></div></div></div><div id="content" data-github-owner="freechipsproject" data-github-repo="chisel3"><div class="content-wrapper"><section><h1 id="chisel3-vs-chisel2">Chisel3 vs Chisel2</h1>

<h2 id="chisel2-migration">Chisel2 Migration</h2>
<p>For those moving from Chisel2, there were some backwards incompatible changes
and your RTL needs to be modified to work with Chisel3. The required
modifications are:</p>

<ul>
  <li>Wire declaration style:
    <div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">val</span> <span class="nv">wire</span> <span class="k">=</span> <span class="nc">UInt</span><span class="o">(</span><span class="n">width</span> <span class="k">=</span> <span class="mi">15</span><span class="o">)</span>
</code></pre></div>    </div>
    <p>becomes (in Chisel3):</p>
    <div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="nv">wire</span> <span class="k">=</span> <span class="nc">Wire</span><span class="o">(</span><span class="nc">UInt</span><span class="o">(</span><span class="mf">15.</span><span class="n">W</span><span class="o">))</span>
</code></pre></div>    </div>
  </li>
  <li>I/O declaration style:
    <div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="nv">done</span> <span class="k">=</span> <span class="nc">Bool</span><span class="o">(</span><span class="nc">OUTPUT</span><span class="o">)</span>
</code></pre></div>    </div>
    <p>becomes (in Chisel3):</p>
    <div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="nv">wire</span> <span class="k">=</span> <span class="nc">Output</span><span class="o">(</span><span class="nc">Bool</span><span class="o">())</span>
</code></pre></div>    </div>
  </li>
  <li>Sequential memories:</li>
</ul>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="k">val</span> <span class="nv">addr</span> <span class="k">=</span> <span class="nc">Reg</span><span class="o">(</span><span class="nc">UInt</span><span class="o">())</span>
   <span class="k">val</span> <span class="nv">mem</span> <span class="k">=</span> <span class="nc">Mem</span><span class="o">(</span><span class="nc">UInt</span><span class="o">(</span><span class="mf">8.</span><span class="n">W</span><span class="o">),</span> <span class="mi">1024</span><span class="o">,</span> <span class="n">seqRead</span> <span class="k">=</span> <span class="kc">true</span><span class="o">)</span>
   <span class="k">val</span> <span class="nv">dout</span> <span class="k">=</span> <span class="nf">when</span><span class="o">(</span><span class="n">enable</span><span class="o">)</span> <span class="o">{</span> <span class="nf">mem</span><span class="o">(</span><span class="n">addr</span><span class="o">)</span> <span class="o">}</span>
</code></pre></div></div>
<p>becomes (in Chisel3):</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="nv">addr</span> <span class="k">=</span> <span class="nc">UInt</span><span class="o">()</span>
   <span class="k">val</span> <span class="nv">mem</span> <span class="k">=</span> <span class="nc">SyncReadMem</span><span class="o">(</span><span class="mi">1024</span><span class="o">,</span> <span class="nc">UInt</span><span class="o">(</span><span class="mf">8.</span><span class="n">W</span><span class="o">))</span>
   <span class="k">val</span> <span class="nv">dout</span> <span class="k">=</span> <span class="nv">mem</span><span class="o">.</span><span class="py">read</span><span class="o">(</span><span class="n">addr</span><span class="o">,</span> <span class="n">enable</span><span class="o">)</span>
</code></pre></div></div>

<p>Notice the address register is now internal to the SyncReadMem(), but the data
   will still return on the subsequent cycle.</p>

<ul>
  <li>Generating Verilog for a module:</li>
</ul>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="k">object</span> <span class="nc">Hello</span> <span class="o">{</span>
     <span class="k">def</span> <span class="nf">main</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
       <span class="nf">chiselMain</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="s">"--backend"</span><span class="o">,</span> <span class="s">"v"</span><span class="o">),</span> <span class="o">()</span> <span class="k">=&gt;</span> <span class="nc">Module</span><span class="o">(</span><span class="k">new</span> <span class="nc">Hello</span><span class="o">()))</span>
     <span class="o">}</span>
   <span class="o">}</span>
</code></pre></div></div>
<p>becomes (in Chisel3):</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">chisel3.stage.ChiselStage</span>
   <span class="k">object</span> <span class="nc">Hello</span> <span class="o">{</span>
     <span class="k">def</span> <span class="nf">main</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
       <span class="o">(</span><span class="k">new</span> <span class="nc">ChiselStage</span><span class="o">).</span><span class="py">emitVerilog</span><span class="o">(</span><span class="k">new</span> <span class="nc">Hello</span><span class="o">())</span>
     <span class="o">}</span>
   <span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>Package changes:
    <ul>
      <li>Chisel.log2Ceil -&gt; chisel3.util.log2Ceil</li>
      <li>BitPat</li>
      <li>Decoupled is also in chisel3.util</li>
    </ul>
  </li>
</ul>

<p>Please refer to the <a href="https://github.com/ucb-bar/chisel#chisel3">Chisel3 compatibility section</a>
for instructions on preparing your Chisel2 designs for Chisel3.</p>

<h2 id="deprecated-usage">Deprecated Usage</h2>
<ul>
  <li><code class="language-plaintext highlighter-rouge">Vec(Reg)</code> should be replaced with <code class="language-plaintext highlighter-rouge">Reg(Vec)</code>,</li>
  <li>type-only vals (no associated data) must be wrapped in a <code class="language-plaintext highlighter-rouge">Wire()</code> if they will be the destination of a wiring operation (“:=” or “ &lt; &gt;”),</li>
  <li>masked bit patterns (‘b??’) should be created using BitPat(), not UInt() or Bits(),</li>
  <li>the <code class="language-plaintext highlighter-rouge">clone</code> method required for parameterized Bundles has been renamed <code class="language-plaintext highlighter-rouge">cloneType</code>,</li>
  <li>the con and alt inputs to a Mux must be type-compatible - both signed or both unsigned,</li>
  <li>bulk-connection to a node that has been procedurally assigned-to is illegal,</li>
  <li><code class="language-plaintext highlighter-rouge">!=</code> is deprecated, use <code class="language-plaintext highlighter-rouge">=/=</code> instead,</li>
  <li>use <code class="language-plaintext highlighter-rouge">SyncReadMem(...)</code> instead of <code class="language-plaintext highlighter-rouge">Mem(..., seqRead)</code>,</li>
  <li>use <code class="language-plaintext highlighter-rouge">SyncReadMem(n:Int, out: =&gt; T)</code> instead of <code class="language-plaintext highlighter-rouge">SyncReadMem(out: =&gt; T, n:Int)</code>,</li>
  <li>use <code class="language-plaintext highlighter-rouge">SyncReadMem(...)</code> instead of <code class="language-plaintext highlighter-rouge">SeqMem(...)</code>,</li>
  <li>use <code class="language-plaintext highlighter-rouge">Mem(n:Int, t:T)</code> instead of <code class="language-plaintext highlighter-rouge">Mem(out:T, n:Int)</code>,</li>
  <li>use <code class="language-plaintext highlighter-rouge">Vec(n:Int, gen: =&gt; T)</code> instead of <code class="language-plaintext highlighter-rouge">Vec(gen: =&gt; T, n:Int)</code>,</li>
  <li>module io’s must be wrapped in <code class="language-plaintext highlighter-rouge">IO()</code>.</li>
  <li>The methods <code class="language-plaintext highlighter-rouge">asInput</code>, <code class="language-plaintext highlighter-rouge">asOutput</code>, and <code class="language-plaintext highlighter-rouge">flip</code> should be replaced by the <code class="language-plaintext highlighter-rouge">Input()</code>, <code class="language-plaintext highlighter-rouge">Output()</code>, and <code class="language-plaintext highlighter-rouge">Flipped()</code> object apply methods.</li>
</ul>

<h2 id="unsupported-constructs">Unsupported constructs</h2>
<ul>
  <li><code class="language-plaintext highlighter-rouge">Mem(..., orderedWrites)</code> is no longer supported,</li>
  <li>masked writes are only supported for <code class="language-plaintext highlighter-rouge">Mem[Vec[_]]</code>,</li>
  <li>Chisel3 Vecs must all have the same type, unlike with Chisel2. Use <code class="language-plaintext highlighter-rouge">MixedVec</code> (see <a href="../explanations/bundles-and-vecs">Bundles and Vecs</a>) for Vecs where the elements are of different types.</li>
  <li>connections between <code class="language-plaintext highlighter-rouge">UInt</code> and <code class="language-plaintext highlighter-rouge">SInt</code> are illegal.</li>
  <li>the <code class="language-plaintext highlighter-rouge">Node</code> class and object no longer exist (the class should have been private in Chisel2)</li>
  <li><code class="language-plaintext highlighter-rouge">printf()</code> is defined in the Chisel object and produces simulation printf()’s.
To use the Scala <code class="language-plaintext highlighter-rouge">Predef.printf()</code>, you need to qualify it with <code class="language-plaintext highlighter-rouge">Predef</code>.</li>
  <li>in Chisel2, bulk-connects <code class="language-plaintext highlighter-rouge">&lt;&gt;</code> with unconnected source components do not update connections from the unconnected components.
** In Chisel3, bulk-connects strictly adhere to last connection semantics and unconnected OUTPUTs will be connected to INPUTs resulting in the assignment of random values to those inputs.</li>
  <li>In Chisel3, adding hardware inside <code class="language-plaintext highlighter-rouge">BlackBox</code> for simulation is no longer supported. (#289)</li>
  <li><code class="language-plaintext highlighter-rouge">ChiselError</code> is gone
    <ul>
      <li>Change <code class="language-plaintext highlighter-rouge">ChiselError.error("error msg")</code> to <code class="language-plaintext highlighter-rouge">throw new Error("error msg")</code></li>
      <li>Change <code class="language-plaintext highlighter-rouge">ChiselError.info("info msg")</code> to <code class="language-plaintext highlighter-rouge">println("info msg")</code></li>
    </ul>
  </li>
  <li>In Chisel3, subword assignments are not supported. <a href="https://github.com/freechipsproject/chisel3/wiki/Cookbook#how-do-i-do-subword-assignment-assign-to-some-bits-in-a-uint">Alternative constructions exist</a> in Chisel3.</li>
</ul>

<h2 id="further-changes">Further changes</h2>
<ul>
  <li>The clock signal was renamed from <code class="language-plaintext highlighter-rouge">clk</code> to <code class="language-plaintext highlighter-rouge">clock</code> in Chisel3.</li>
  <li>Change <code class="language-plaintext highlighter-rouge">getWidth()</code> to <code class="language-plaintext highlighter-rouge">getWidth</code></li>
</ul>

<h2 id="packaging">Packaging</h2>
<p>Chisel3 is implemented as several packages.
The core DSL is differentiated from utility or library classes and objects, testers, and interpreters.
The prime components of the Chisel3 front end (the DSL and library objects) are:</p>
<ul>
  <li>coreMacros - source locators provide Chisel line numbers for <code class="language-plaintext highlighter-rouge">firrtl</code> detected errors,</li>
  <li>chiselFrontend - main DSL components,</li>
  <li>chisel3 - compiler driver, interface packages, compatibility layer.</li>
</ul>

<p>Due to the wonders of <code class="language-plaintext highlighter-rouge">sbt</code>, you need only declare a dependency on the chisel3 package, and the others will be downloaded as required.</p>

<p>The <code class="language-plaintext highlighter-rouge">firrtl</code> compiler is distributed as a separate package, and release versions will also be downloaded automatically as required.
If you choose to integrate the compiler into your own toolchain, or you’re working with the development (master) branch of chisel3, you should clone the <a href="https://github.com/ucb-bar/firrtl">firrtl</a> repo
and follow the instructions for installing the <code class="language-plaintext highlighter-rouge">firrtl</code> compiler.</p>

<p>The testers in Chisel3 are distributed as a separate package.
If you intend to use them in your tests, you will either need to clone the <a href="https://github.com/ucb-bar/chisel-testers">chisel-testers</a> repo
or declare a dependency on the published version of the package.
See the <code class="language-plaintext highlighter-rouge">build.sbt</code> file in either the <a href="https://github.com/ucb-bar/chisel-template">chisel-template</a> or <a href="https://github.com/ucb-bar/chisel-tutorial">chisel-tutorial</a>
repos for examples of the latter.</p>

<h2 id="simulation">Simulation</h2>
<p>Chisel2 was capable of directly generating a <code class="language-plaintext highlighter-rouge">C++</code> simulation from the Chisel code, or a harness for use with a <code class="language-plaintext highlighter-rouge">vcs</code> simulation.
Chisel3 relies on <a href="http://www.veripool.org/wiki/verilator">verilator</a> to generate the <code class="language-plaintext highlighter-rouge">C++</code> simulation from the Verilog output of <code class="language-plaintext highlighter-rouge">firrtl</code>.
See the <a href="https://github.com/ucb-bar/chisel3">Chisel3 README</a> for directions on installing <code class="language-plaintext highlighter-rouge">verilator</code>.</p>

<h2 id="compile-options-and-front-end-checks-strict-vs-notstrict">Compile Options and Front End Checks (Strict vs. NotStrict)</h2>
<p>Chisel3 introduces a formal specification for hardware circuit graphs: FIRRTL,
and Chisel3 itself (the Scala library implementing the Chisel DSL), is a relatively thin front end that generates FIRRTL.
Since the <code class="language-plaintext highlighter-rouge">firrtl</code> parser needs to validate FIRRTL input, most of the checks that were performed in Chisel2 were eliminated
from the initial Chisel3 front end (the DRY principle).</p>

<p>However, this does impact the ability to provide detailed messages for error conditions that could be detected in the Chisel3
front end. The decision was made to optionally enable stricter error checking (for connections and the use of raw types versus
hardware objects), based on specific imports.
This allows designs to move from less strict front end checks (largely compatible with Chisel2), to stricter checking,
on a file by file basis, by adjusting specific import statements.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">chisel3.ExplicitCompileOptions.Strict</span>
</code></pre></div></div>

<p>enables stricter connection and usage checks, while</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">chisel3.ExplicitCompileOptions.NotStrict</span>
</code></pre></div></div>

<p>defers these checks to the <code class="language-plaintext highlighter-rouge">firrtl</code> compiler.</p>

<p>By default, the <code class="language-plaintext highlighter-rouge">Chisel</code> compatibility layer, invoked by:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">import</span> <span class="nn">Chisel._</span>
</code></pre></div></div>

<p>implicitly defines the compile options as <code class="language-plaintext highlighter-rouge">chisel3.core.ExplicitCompileOptions.NotStrict</code></p>

<p>whereas the Chisel3 package, invoked by:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">import</span> <span class="nn">chisel3._</span>
</code></pre></div></div>

<p>implicitly defines the compile options as <code class="language-plaintext highlighter-rouge">chisel3.core.ExplicitCompileOptions.Strict</code></p>

<p>Again, these implicit compile options definitions may be overridden by explicit imports.</p>

<p>Currently, the specific error checks (found in <a href="https://github.com/ucb-bar/chisel3/blob/master/chiselFrontend/src/main/scala/chisel3/core/CompileOptions.scala">CompileOptions.scala</a>) are:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">trait</span> <span class="nc">CompileOptions</span> <span class="o">{</span>
      <span class="c1">// Should Bundle connections require a strict match of fields.</span>
      <span class="c1">// If true and the same fields aren't present in both source and sink, a MissingFieldException,</span>
      <span class="c1">// MissingLeftFieldException, or MissingRightFieldException will be thrown.</span>
      <span class="k">val</span> <span class="nv">connectFieldsMustMatch</span><span class="k">:</span> <span class="kt">Boolean</span>
      <span class="c1">// When creating an object that takes a type argument, the argument must be unbound (a pure type).</span>
      <span class="k">val</span> <span class="nv">declaredTypeMustBeUnbound</span><span class="k">:</span> <span class="kt">Boolean</span>
      <span class="c1">// Module IOs should be wrapped in an IO() to define their bindings before the reset of the module is defined.</span>
      <span class="k">val</span> <span class="nv">requireIOWrap</span><span class="k">:</span> <span class="kt">Boolean</span>
      <span class="c1">// If a connection operator fails, don't try the connection with the operands (source and sink) reversed.</span>
      <span class="k">val</span> <span class="nv">dontTryConnectionsSwapped</span><span class="k">:</span> <span class="kt">Boolean</span>
      <span class="c1">// If connection directionality is not explicit, do not use heuristics to attempt to determine it.</span>
      <span class="k">val</span> <span class="nv">dontAssumeDirectionality</span><span class="k">:</span> <span class="kt">Boolean</span>
      <span class="c1">// Issue a deprecation warning if Data.{flip, asInput,asOutput} is used</span>
      <span class="c1">// instead of Flipped, Input, or Output.</span>
      <span class="k">val</span> <span class="nv">deprecateOldDirectionMethods</span><span class="k">:</span> <span class="kt">Boolean</span>
      <span class="c1">// Check that referenced Data have actually been declared.</span>
      <span class="k">val</span> <span class="nv">checkSynthesizable</span><span class="k">:</span> <span class="kt">Boolean</span>
    <span class="o">}</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">chisel3.core.ExplicitCompileOptions.Strict</code> sets all CompileOptions fields to true and
<code class="language-plaintext highlighter-rouge">chisel3.core.ExplicitCompileOptions.NotStrict</code> sets them all to false.
Clients are free to define their own settings for these options.
Examples may be found in the test <a href="https://github.com/ucb-bar/chisel3/blob/master/src/test/scala/chiselTests/CompileOptionsTest.scala">CompileOptionsSpec</a></p>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/highlight/highlight.pack.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/verilog.min.js"></script><script src="/lunr/lunr.js"></script><script>
// For all code blocks, copy the language from the containing div
// to the inner code tag (where hljs expects it to be)
const langPrefix = 'language-';
document.querySelectorAll(`div[class^='${langPrefix}']`).forEach(function(div) {
  div.classList.forEach(function(cssClass) {
    if (cssClass.startsWith(langPrefix)) {
      const lang = cssClass.substring(langPrefix.length);
      div.querySelectorAll('pre code').forEach(function(code) {
        code.classList.add(lang);
      });
    }
  });
});

hljs.configure({languages:['scala','java','bash','verilog']});
hljs.initHighlightingOnLoad();
      </script><script>console.info('\x57\x65\x62\x73\x69\x74\x65\x20\x62\x75\x69\x6c\x74\x20\x77\x69\x74\x68\x3a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x5f\x5f\x0a\x20\x20\x20\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x5f\x20\x20\x2f\x20\x2f\x5f\x20\x20\x20\x20\x20\x20\x5f\x5f\x5f\x5f\x20\x5f\x5f\x5f\x20\x20\x28\x5f\x29\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x28\x5f\x29\x20\x2f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x0a\x20\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x60\x5f\x5f\x20\x5c\x2f\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x20\x2f\x20\x5f\x5f\x2f\x20\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x0a\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x5f\x2f\x20\x2f\x20\x2f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x5f\x5f\x2f\x20\x2f\x20\x20\x2f\x20\x2f\x5f\x2f\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x20\x2f\x5f\x2f\x20\x20\x5f\x5f\x28\x5f\x5f\x20\x20\x29\x0a\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2e\x5f\x5f\x5f\x2f\x5c\x5f\x5f\x2f\x20\x20\x20\x20\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x2f\x20\x20\x20\x5c\x5f\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x0a\x0a\x68\x74\x74\x70\x73\x3a\x2f\x2f\x34\x37\x64\x65\x67\x2e\x67\x69\x74\x68\x75\x62\x2e\x69\x6f\x2f\x73\x62\x74\x2d\x6d\x69\x63\x72\x6f\x73\x69\x74\x65\x73')</script><script>((window.gitter = {}).chat = {}).options = {
room: 'freechipsproject/chisel3'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/js/search.js"></script><script src="/js/main.js"></script></body></html>